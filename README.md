# nEM
This repository refers to the paper  [Durante, D., Canale, A. and Rigon, T. (2017). *A nested expectation-maximization algorithm for latent class models with covariates* \[arXiv:1705.03864\]](https://arxiv.org/abs/1705.03864), where we propose a novel **nested EM** for improved maximum likelihood estimation of **latent class models with covariates**. The proposed **nested EM**  relies on a sequence of conditional expectation-maximizations which leverage the recently developed [Pòlya-gamma data augmentation](http://www.tandfonline.com/doi/abs/10.1080/01621459.2013.829001) for logistic regression to obtain simple and exact M-steps via  generalized least squares. As we discuss in the paper, differently from current algorithms for latent class models with covariates, the proposed **nested EM** provides a monotone log-likelihood sequence, and allows improvements in maximization performance, according to empirical studies.

## Source code

The repository contains the source functions [`LCA-Covariates-Algorithms.R`](https://github.com/danieledurante/nEM/blob/master/LCA-Covariates-Algorithms.R) for the implementation of the proposed **nested EM** (and an hybrid version of the **nested EM**), along with additional algorithms routinely considered in the estimation of **latent class models with covariates**. 

## Empirical performance assessments

As we show in Section 3.1 of the paper [Durante, D., Canale, A. and Rigon, T. (2017). *A nested expectation-maximization algorithm for latent class models with covariates* \[arXiv:1705.03864\]](https://arxiv.org/abs/1705.03864), the **nested EM** provides substantial improvements in maximization performance, compared to current algorithms. The analyses in Section 3.1 can be reproduced using the tutorial `Application to Cheating Data` and `Application to Election Data`, respectively. In particular

 - The folder [`Application to Cheating Data`](https://github.com/danieledurante/nEM/tree/master/Application%20to%20Cheating%20Data) considers the analysis of the `cheating` dataset from the `R` library [`poLCA`](https://www.jstatsoft.org/article/view/v042i10), discussed in Section 3.1. The basic `R` file [`Cheating-Data-Basic-R-Code.R`](https://github.com/danieledurante/nEM/blob/master/Application%20to%20Cheating%20Data/Cheating-Data-Basic-R-Code.R) provides the code to reproduce Table 1 and the left plot of Figure 2 in the paper, whereas the file [`Cheating-Data-Tutorial.md`](https://github.com/danieledurante/nEM/blob/master/Application%20to%20Cheating%20Data/Cheating-Data-Tutorial.md) contains a detailed tutorial implementation of the basic `R` code with additional comments. 
 - The folder [`Application to Election Data`](https://github.com/danieledurante/nEM/tree/master/Application%20to%20Election%20Data) considers the analysis of the `election` dataset from the `R` library [`poLCA`](https://www.jstatsoft.org/article/view/v042i10), discussed in Section 3.2. The basic `R` file [`Election-Data-Basic-R-Code.R`](https://github.com/danieledurante/nEM/blob/master/Application%20to%20Election%20Data/Election-Data-Basic-R-Code.R) provides the code to reproduce Table 2 and the right plot of Figure 2 in the paper, whereas the file [`Election-Data-Tutorial.md`](https://github.com/danieledurante/nEM/blob/master/Application%20to%20Election%20Data/Election-Data-Tutorial.md) contains a detailed tutorial implementation of the basic `R` code with additional comments. 
